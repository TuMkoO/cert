{"version":3,"sources":["webpack:///./src/views/Profile.vue","webpack:///./src/views/Profile.vue?b467"],"names":["class","for","type","title","loading","onSubmit","eError","id","email","nError","name","to","setup","store","user","handleSubmit","isSubmitting","submitCount","trim","required","value","errorMessage","eBlur","handleBlur","min","nBlur","getters","dispatch","values","components","AppPage","AppLoader","__exports__","render"],"mappings":"oJAESA,MAAM,a,EACT,gCAEM,OAFDA,MAAM,QAAM,CACf,gCAA6C,MAAzCA,MAAM,oBAAmB,iB,YAGnBA,MAAM,W,GACXA,MAAM,O,GAEFA,MAAM,Q,EACT,gCAAwD,SAAjDC,IAAI,aAAaD,MAAM,cAAa,SAAK,G,SAO7BA,MAAM,yB,GAItBA,MAAM,Q,EACT,gCAAqD,SAA9CC,IAAI,YAAYD,MAAM,cAAa,OAAG,G,SAOxCA,MAAM,yB,GAIRA,MAAM,Q,+BACmB,kB,EAG9B,gCAES,UAFDE,KAAK,SAASF,MAAM,wBAAuB,eAEnD,G,qMAvCV,yBA4CW,GA5CDG,MAAM,eAAa,C,8BAC3B,iBA0CM,CA1CN,gCA0CM,MA1CN,EA0CM,CAzCJ,EAGkB,EAAAC,S,yBAAlB,yBAAwC,a,yBACxC,gCAoCM,MApCN,EAoCM,CAnCJ,gCAkCM,MAlCN,EAkCM,CAjCJ,gCAgCO,QAhCA,SAAM,0DAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC7B,gCAWM,MAXN,EAWM,CAVJ,E,4BACA,gCAKE,SAJAH,KAAK,QACJF,MAAK,0DAAmC,EAAAM,UACzCC,GAAG,a,qDACM,EAAAC,MAAK,K,0BAAL,EAAAA,SAEA,EAAAF,Q,yBAAX,gCAEM,MAFN,EAEM,6BADD,EAAAA,QAAM,I,yCAGb,gCAWM,MAXN,EAWM,CAVJ,E,4BACA,gCAKE,SAJAJ,KAAK,OACJF,MAAK,0DAAmC,EAAAS,UACzCF,GAAG,Y,qDACM,EAAAG,KAAI,K,0BAAJ,EAAAA,QAE8B,EAAAD,Q,yBAAzC,gCAEM,MAFN,EAEM,6BADD,EAAAA,QAAM,I,yCAGb,gCAEM,MAFN,EAEM,CADJ,yBAAwD,GAA3CE,GAAG,aAAW,C,8BAAC,iBAAc,C,cAG5C,G,uHAkBG,GACbC,MADa,WAGX,IAAMC,EAAQ,iBAERT,EAAU,kBAAI,GAEdU,EAAO,iBAAI,MAEXP,EAAK,iBAAI,MAEf,EAAoD,iBAA5CQ,EAAR,EAAQA,aAAcC,EAAtB,EAAsBA,aAEtB,GAFA,EAAoCC,YAE8B,eAChE,QACA,SAEGC,OACAC,SAAS,6BACTX,MAAM,wCANIA,EAAf,EAAQY,MAA4Bd,EAApC,EAAsBe,aAAkCC,EAAxD,EAA4CC,WAS5C,EAAiE,eAC/D,OACA,SAEGL,OACAC,SAAS,2BACTK,IAAI,EAAG,wCANGd,EAAf,EAAQU,MAA2BX,EAAnC,EAAqBY,aAAkCI,EAAvD,EAA2CF,WAmB3C,uBAAS,wCAAC,iGACRnB,EAAQgB,OAAQ,EAEhBb,EAAGa,MAAQP,EAAMa,QAAQ,aAAanB,GAEjCA,EAAGa,MALA,gCAMWP,EAAMc,SAAS,0BAN1B,OAMNpB,EAAGa,MANG,8BAQWP,EAAMc,SAAS,oBAAqBpB,EAAGa,OARlD,OAQRN,EAAKM,MARG,OAURZ,EAAMY,MAAQN,EAAKM,MAAMZ,MACzBE,EAAKU,MAAQN,EAAKM,MAAMV,KAExBN,EAAQgB,OAAQ,EAbR,6CAiBV,IAAMf,EAAWU,EAAY,yDAAC,WAAOa,GAAP,0GAEpBf,EAAMc,SAAS,cAAeC,GAFV,iHAAD,uDAM7B,MAAO,CACLd,OACAV,UAEAI,QACAE,OACAJ,SACAG,SACAa,QACAG,QACApB,WACAW,iBAIJa,WAAY,CAAEC,UAAA,KAASC,YAAA,O,qBClIzB,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d217357.2349427e.js","sourcesContent":["<template>\r\n  <app-page title=\"Мой профиль\">\r\n    <div class=\"container\">\r\n      <div class=\"py-4\">\r\n        <h4 class=\"text-center mb-4\">Мой профиль</h4>\r\n      </div>\r\n      <app-loader v-if=\"loading\"></app-loader>\r\n      <div v-else class=\"profile\">\r\n        <div class=\"row\">\r\n          <form @submit.prevent=\"onSubmit\">\r\n            <div class=\"mb-3\">\r\n              <label for=\"inputEmail\" class=\"form-label\">Email</label>\r\n              <input\r\n                type=\"email\"\r\n                :class=\"['form-control', { 'is-invalid': eError }]\"\r\n                id=\"inputEmail\"\r\n                v-model=\"email\"\r\n              />\r\n              <div v-if=\"eError\" class=\"form-text text-danger\">\r\n                {{ eError }}\r\n              </div>\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"inputName\" class=\"form-label\">Имя</label>\r\n              <input\r\n                type=\"text\"\r\n                :class=\"['form-control', { 'is-invalid': nError }]\"\r\n                id=\"inputName\"\r\n                v-model=\"name\"\r\n              />\r\n              <div class=\"form-text text-danger\" v-if=\"nError\">\r\n                {{ nError }}\r\n              </div>\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <router-link to=\"/password\">Сменить пароль</router-link>\r\n            </div>\r\n\r\n            <button type=\"submit\" class=\"btn btn-primary mt-3\">\r\n              Сохранить\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </app-page>\r\n</template>\r\n\r\n<script>\r\nimport { onMounted, ref, computed, watch } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { useField, useForm } from \"vee-validate\";\r\nimport * as yup from \"yup\";\r\nimport AppPage from \"../components/ui/AppPage\";\r\nimport AppLoader from \"../components/ui/AppLoader.vue\";\r\n\r\nexport default {\r\n  setup() {\r\n    //store\r\n    const store = useStore();\r\n    //loader\r\n    const loading = ref(false);\r\n    //user\r\n    const user = ref(null);\r\n    //user id\r\n    const id = ref(null);\r\n\r\n    const { handleSubmit, isSubmitting, submitCount } = useForm();\r\n\r\n    const { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\r\n      \"email\",\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required(\"Пожалуйста, введите email\")\r\n        .email(\"Необходимо ввести корректный email\")\r\n    );\r\n\r\n    const { value: name, errorMessage: nError, handleBlur: nBlur } = useField(\r\n      \"name\",\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required(\"Пожалуйста, введите имя\")\r\n        .min(5, \"Имя не может быть меньше 5 символов\")\r\n    );\r\n\r\n    // количество кликов подряд по кнопке входа\r\n    // const isTooManyAttempts = computed(() => submitCount.value >= 3);\r\n\r\n    // разблокировать кнопку входу через время\r\n    // watch(isTooManyAttempts, (val) => {\r\n    //   if (val) {\r\n    //     setTimeout(() => (submitCount.value = 0), 1500);\r\n    //   }\r\n    // });\r\n\r\n    onMounted(async () => {\r\n      loading.value = true;\r\n\r\n      id.value = store.getters[\"auth/user\"].id;\r\n      // console.log(\"id.value :::\", id.value);\r\n      if (!id.value) {\r\n        id.value = await store.dispatch(\"auth/loadCurrentUserId\");\r\n      }\r\n      user.value = await store.dispatch(\"auth/loadUserById\", id.value);\r\n\r\n      email.value = user.value.email;\r\n      name.value = user.value.name;\r\n\r\n      loading.value = false;\r\n    });\r\n\r\n    // функция обновления профиля\r\n    const onSubmit = handleSubmit(async (values) => {\r\n      try {\r\n        await store.dispatch(\"auth/update\", values);\r\n      } catch (e) {}\r\n    });\r\n\r\n    return {\r\n      user,\r\n      loading,\r\n\r\n      email,\r\n      name,\r\n      eError,\r\n      nError,\r\n      eBlur,\r\n      nBlur,\r\n      onSubmit,\r\n      isSubmitting,\r\n      // isTooManyAttempts,\r\n    };\r\n  },\r\n  components: { AppPage, AppLoader },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import { render } from \"./Profile.vue?vue&type=template&id=539df294\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\_web-prog\\\\JavaScript\\\\_projects\\\\certificate\\\\client\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}